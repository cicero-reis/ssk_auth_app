#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"
set -e

echo "\nğŸ” Verificando PHP CS Fixer (dry-run + diff + risky)â€¦"
./vendor/bin/php-cs-fixer fix --dry-run --diff --allow-risky=yes || true

echo "\nğŸ”§ Corrigindo PHP CS Fixer (apply + risky)â€¦"
./vendor/bin/php-cs-fixer fix --allow-risky=yes --using-cache=yes

echo "ğŸ“Œ Adicionando arquivos modificados ao commitâ€¦"
git add .

echo
echo "ğŸ” Rodando PHPStan (level max)â€¦"
./vendor/bin/phpstan analyse app --level=5

echo
echo "âœ… Qualidade de cÃ³digo aprovada!"

echo
echo "ğŸš€ Executando Pestâ€¦"
./vendor/bin/pest --stop-on-failure --colors=always

echo
echo "âœ… Todos os testes passaram!"
